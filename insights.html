<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Insights</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div
      id="insights-card"
      style="
        max-width: 400px;
        margin: 40px auto 0 auto;
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
        padding: 32px 28px 24px 28px;
        font-family: 'Segoe UI', Arial, sans-serif;
        text-align: center;
      "
    >
      <h2 style="margin-bottom: 18px; color: #16213e">Your MCAT Progress</h2>
      <div style="font-size: 1.1rem; margin-bottom: 14px">
        <strong>Questions answered:</strong>
        <span id="answered-count" style="color: #0078d4; font-weight: bold"
          >0</span
        >
        /
        <span id="total-questions" style="color: #888">1626</span>
      </div>
      <div style="font-size: 1.1rem; margin-bottom: 14px">
        <strong>Questions left:</strong>
        <span id="questions-left" style="color: #373737; font-weight: bold"
          >0</span
        >
      </div>
      <div
        style="
          display: flex;
          justify-content: center;
          gap: 24px;
          margin-top: 18px;
        "
      >
        <div>
          <span
            style="font-size: 1.1rem; color: #27ae60; font-weight: bold"
            id="correct-count"
            >0</span
          ><br />
          <span style="font-size: 0.98rem; color: #555">Correct</span>
        </div>
        <div>
          <span
            style="font-size: 1.1rem; color: #c0392b; font-weight: bold"
            id="incorrect-count"
            >0</span
          ><br />
          <span style="font-size: 0.98rem; color: #555">Incorrect</span>
        </div>
      </div>
      <div id="progress-bar-container" style="margin-top: 28px">
        <div
          style="
            background: #e0e0e0;
            border-radius: 8px;
            height: 18px;
            width: 100%;
            overflow: hidden;
          "
        >
          <div
            id="progress-bar"
            style="
              background: linear-gradient(90deg, #0078d4, #27ae60);
              height: 100%;
              width: 0%;
              transition: width 0.6s;
              border-radius: 8px;
            "
          ></div>
        </div>
        <div
          id="progress-label"
          style="margin-top: 6px; font-size: 0.98rem; color: #333"
        ></div>
      </div>
    </div>

    <script>
      let answeredCount = 0;
      let correctCount = 0;
      let incorrectCount = 0;
      const totalQuestions = 1626;

      // Loop through all localStorage keys
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith("quizProgress_")) {
          try {
            const progress = JSON.parse(localStorage.getItem(key));
            if (progress && Array.isArray(progress.answeredQuestions)) {
              answeredCount += progress.answeredQuestions.length;
            }
            if (progress && typeof progress.score === "number") {
              correctCount += progress.score;
            }
            if (
              progress &&
              Array.isArray(progress.answeredQuestions) &&
              typeof progress.score === "number"
            ) {
              incorrectCount +=
                progress.answeredQuestions.length - progress.score;
            }
          } catch (e) {
            // Ignore parse errors
          }
        }
      }
      document.getElementById("answered-count").textContent = answeredCount;
      document.getElementById("total-questions").textContent = totalQuestions;
      document.getElementById("questions-left").textContent = Math.max(
        totalQuestions - answeredCount,
        0
      );
      document.getElementById("correct-count").textContent = correctCount;
      document.getElementById("incorrect-count").textContent = incorrectCount;

      // Progress bar
      const progressBar = document.getElementById("progress-bar");
      const progressLabel = document.getElementById("progress-label");
      const progressPercentage = (
        (answeredCount / totalQuestions) *
        100
      ).toFixed(2);
      progressBar.style.width = `${progressPercentage}%`;
      progressLabel.textContent = `${progressPercentage}% completed`;
    </script>
    <script src="sidebar.js"></script>
  </body>
</html>
